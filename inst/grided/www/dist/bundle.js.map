{"version":3,"sources":["grid-helpers.ts","maybe_make_el.ts","draw_browser_header.ts","make_incrementer.ts","focused_modal.ts","make_css_unit_input.ts","index.ts","../../../../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"bundle.js","sourceRoot":"..","sourcesContent":["// Functions related to grid construction\n\n// Builds the start/end css string for a grid-{row,column}\nexport function make_template_start_end([start, end]) {\n  // If we only have a single value just assume we take up one row\n  // If single index is a negative one, we need to subtract instead of add to it\n  const negative_index = start < 0;\n\n  // Grid works with lines so if we want an element to end at the 4th column we\n  // need to tell it to end at the (4+1)5th line, so we add one\n  end = end ? +end + 1 : start + (negative_index ? -1 : 1);\n\n  return `${start} / ${end}`;\n}\n\nexport function set_element_in_grid(el, grid_bounds) {\n  el.style.gridRow = make_template_start_end(grid_bounds.row);\n  el.style.gridColumn = make_template_start_end(grid_bounds.col);\n}\n\n// grid-template-{column,row}: ...\n// Take a vector of css sizes and turn into the format for the css argument for\nexport function sizes_to_template_def(defs) {\n  return defs.reduce((css, curr) => `${css} ${curr}`, \"\");\n}\n","import { make_template_start_end } from \"./grid-helpers\";\n\n// This is a heavy-lifter that takes care of building elements and placing them\n// on the grid etc.. It only create's an element if it needs to, which means\n// that we dont get dom leaks caused by recalling stuff over and over again.\nexport function maybe_make_el(\n  parent,\n  sel_txt,\n  {\n    event_listener,\n    styles,\n    innerHTML,\n    data_props,\n    grid_rows,\n    grid_cols,\n    props,\n  } = {}\n) {\n  const get_tag_regex = /^([^#\\.]+)+/g;\n  const get_id_regex = /(?<=#)([^\\.]+)/g;\n  const get_class_regex = /(?<=\\.)([^\\.#]+)/g;\n\n  const tag_type = sel_txt.match(get_tag_regex);\n  const el_id = sel_txt.match(get_id_regex);\n  const class_list = sel_txt.match(get_class_regex);\n\n  let el = parent.querySelector(sel_txt);\n  if (!el) {\n    // Element doesn't exists so we need to make it\n    el = document.createElement(tag_type);\n    if (el_id) {\n      el.id = el_id[0];\n    }\n\n    if (class_list) {\n      class_list.forEach((x) => el.classList.add(x));\n    }\n\n    if (props) {\n      Object.assign(el, props);\n    }\n\n    parent.appendChild(el);\n  }\n\n  if (event_listener) {\n    const listeners =\n      event_listener instanceof Array ? event_listener : [event_listener];\n\n    listeners.forEach(\n      (listener) => (el[\"on\" + listener.event] = listener.func)\n    );\n  }\n\n  if (styles) {\n    Object.assign(el.style, styles);\n  }\n\n  if (innerHTML) {\n    el.innerHTML = innerHTML;\n  }\n\n  if (data_props) {\n    Object.assign(el.dataset, data_props);\n  }\n\n  if (grid_rows) {\n    el.style.gridRow = make_template_start_end(grid_rows);\n  }\n  if (grid_cols) {\n    el.style.gridColumn = make_template_start_end(grid_cols);\n  }\n\n  return el;\n}\n\n// Given a list of elements from a query selector, remove them all\nexport function remove_elements(els_to_remove) {\n  els_to_remove.forEach((e) => e.remove());\n}","import { shiny_exists } from \"./index\";\n\nexport function draw_browser_header() {\n  const header_svg = document.getElementById(\"editor-browser-header\");\n  const {\n    width: width_of_bar,\n    height: height_of_bar,\n  } = header_svg.getBoundingClientRect();\n\n  // Clear out anything that may be in the svg already\n  header_svg.innerHTML = \"\";\n  // First make the buttons for closing, minimizing and maximizing window\n  const button_r = height_of_bar / 4.5;\n  for (let i = 1; i <= 3; i++) {\n    header_svg.innerHTML += `\n    <circle cx=${i * button_r * 3}px\n            cy = 50%\n            r = ${button_r}px\n    > </circle>`;\n  }\n\n  // Next make the browser url bar\n  const url_bar_start = 4 * button_r * 3;\n  // Bar is takes up middle 65% of header area\n  const url_bar_rel_height = 0.65;\n  const url_bar_height = height_of_bar * url_bar_rel_height;\n  const url_bar_margin = (height_of_bar - url_bar_height) / 2;\n  header_svg.innerHTML += `\n  <rect x = ${url_bar_start}px\n        y = ${url_bar_margin}px\n        width = ${width_of_bar - url_bar_start - 10}px\n        height = ${height_of_bar * url_bar_rel_height}px\n        stroke = \"black\"\n        stroke-width: 3px\n        fill = \"none\"\n        rx = ${url_bar_height / 2}px\n        ry = ${url_bar_height / 2}px\n  ></rect>`;\n\n  const url_address = shiny_exists ? \"www.myShinyApp.com\" : \"www.myGridApp.com\";\n  header_svg.innerHTML += `\n  <text x = ${url_bar_start + 13}px\n        y = ${height_of_bar / 2}px\n        alignment-baseline = \"central\"\n  >\n    ${url_address}\n  </text>\n`;\n}\n","import { maybe_make_el } from \"./maybe_make_el\";\n\n// Builds an up down button and value input\nexport function make_incrementer({\n  parent_el,\n  start_val = 2,\n  id = \"incrementer\",\n  label = \"my incrementer\",\n  on_increment = (x) => console.log(x),\n}): (new_value: number) => void {\n  const plus_minus_div = maybe_make_el(\n    parent_el,\n    `div#${id}_incrementer.plus_minus_input`,\n    {\n      innerHTML: `<span>${label}</span>`,\n    }\n  );\n\n  const inputs_div = maybe_make_el(plus_minus_div, \"div.controls\");\n\n  const minus_btn = maybe_make_el(inputs_div, \"button.minus_btn\", {\n    innerHTML: `<i class=\"fa fa-minus\" aria-hidden=\"true\"></i>`,\n    event_listener: {\n      event: \"click\",\n      func: increment_counter(-1),\n    },\n  });\n  const current_value = maybe_make_el(inputs_div, \"span.value\", {\n    innerHTML: start_val,\n  });\n\n  maybe_make_el(inputs_div, \"button.plus_btn\", {\n    innerHTML: `<i class=\"fa fa-plus\" aria-hidden=\"true\"></i>`,\n    event_listener: {\n      event: \"click\",\n      func: increment_counter(1),\n    },\n  });\n\n  function update_value(new_value: number) {\n    current_value.innerHTML = new_value;\n\n    if (new_value === 1) {\n      minus_btn.classList.add(\"disabled\");\n    } else {\n      minus_btn.classList.remove(\"disabled\");\n    }\n  }\n  function increment_counter(amount) {\n    return function () {\n      const new_value = +current_value.innerHTML + amount;\n\n      update_value(new_value);\n      on_increment(new_value);\n    };\n  }\n\n  return update_value;\n}\n","import { maybe_make_el } from \"./maybe_make_el\";\n\nexport function focused_modal({\n  background_callbacks,\n  modal_contents,\n  modal_callbacks,\n}) {\n  const background = maybe_make_el(\n    document.querySelector(\"body\"),\n    \"div.background-blurrer\",\n    {\n      event_listener: background_callbacks,\n    }\n  );\n\n  return {\n    background,\n    modal: maybe_make_el(background, \"div.modal\", {\n      innerHTML: modal_contents,\n      event_listener: modal_callbacks,\n    }),\n    remove: () => background.remove(),\n  };\n}\n","import { maybe_make_el } from \"./maybe_make_el\";\nimport { get_css_value, get_css_unit } from \"./index\";\n\n\nexport interface CSS_Input {\n  form: HTMLElement, \n  current_value: () => string,\n  update_value: (new_value: string) => void \n};\n// =============================================================================\n// From here on are a series of general purpose helper functions not\n// specifically related to the app and its state\n// Input with value text box on left and unit selector dropdown on right\n// Used to make valid css sizes\nexport function make_css_unit_input({\n  parent_el,\n  selector = \"\",\n  start_val = 1,\n  start_unit = \"fr\",\n  on_change = (x) => console.log(\"css unit change\", x),\n  allowed_units = [\"fr\", \"px\", \"rem\"],\n  form_styles = {},\n  drag_dir = \"none\",\n}): CSS_Input {\n  const allow_drag = drag_dir !== \"none\";\n\n  const input_holder = maybe_make_el(\n    parent_el,\n    `div${selector}.input-holder.css-unit-input`,\n    {\n      styles: form_styles,\n    }\n  );\n\n  const form = maybe_make_el(input_holder, `form`, {\n    event_listener: { event: \"change\", func: on_update },\n  });\n\n  const value_input = maybe_make_el(form, \"input\", {\n    props: {\n      type: \"number\",\n      min: 0,\n      value: start_val,\n      step: 1,\n      \"aria-live\": \"polite\",\n    },\n    styles: {\n      minWidth: \"30px\",\n      width: \"100%\",\n      maxWidth: \"55px\",\n    },\n  });\n\n  const unit_selector = maybe_make_el(form, \"select\", {\n    props: { name: \"units\" },\n    styles: {\n      minWidth: \"20px\",\n      marginLeft: \"3px\",\n    },\n  });\n\n  const resizer = maybe_make_el(input_holder, \"div.css-dragger\", {\n    innerHTML: `<i class=\"fa fa-arrows-${\n      drag_dir === \"y\" ? \"v\" : \"h\"\n    }\" aria-hidden=\"true\"></i>`,\n  });\n\n  // Place an invisible div over the main one that we let be dragged. This means\n  // we can use the nice drag interaction callbacks without the ugly default\n  // drag behavior of two copies of the div and zooming back to the start pos etc.\n  maybe_make_el(resizer, \"div.detector\", {\n    props: { draggable: true },\n    event_listener: [\n      {\n        event: \"dragstart\",\n        func: function (event) {\n          this.dataset.baseline = value_input.value;\n          this.dataset.start = event[drag_dir];\n        },\n      },\n      {\n        event: \"drag\",\n        func: function (event) {\n          const drag_pos = event[drag_dir];\n          // At the end of the drag we get a drag event with 0 values that throws stuff off\n          if (drag_pos === 0) return;\n          const new_value = Math.max(\n            0,\n            +this.dataset.baseline + (event[drag_dir] - this.dataset.start)\n          );\n          value_input.value = new_value;\n          on_change(current_value());\n        },\n      },\n    ],\n  });\n\n  allowed_units.forEach(function (unit_type) {\n    const unit_option = maybe_make_el(unit_selector, `option.${unit_type}`, {\n      props: { value: unit_type },\n      innerHTML: unit_type,\n    });\n\n    if (unit_type === start_unit) {\n      unit_option.selected = true;\n    }\n  });\n  function current_value() {\n    return `${value_input.value}${unit_selector.value}`;\n  }\n  function on_update() {\n    const val = current_value();\n    update_value(val);\n    on_change(val);\n  }\n\n  function update_value(new_value) {\n    value_input.value = get_css_value(new_value);\n    const new_unit = get_css_unit(new_value);\n    [...unit_selector.children].forEach((opt) => {\n      if (opt.value === new_unit) {\n        opt.selected = true;\n      } else {\n        opt.selected = false;\n      }\n    });\n\n    if (new_unit === \"px\" && allow_drag) {\n      resizer.style.display = \"block\";\n    } else {\n      resizer.style.display = \"none\";\n    }\n  }\n\n  update_value(`${start_val}${start_unit}`);\n\n  return { form, current_value, update_value };\n}\n","// JS entry point\nimport { maybe_make_el, remove_elements} from \"./maybe_make_el\";\nimport { draw_browser_header } from \"./draw_browser_header\";\nimport { make_incrementer } from \"./make_incrementer\";\nimport { focused_modal } from \"./focused_modal\";\nimport { make_css_unit_input, CSS_Input } from \"./make_css_unit_input\";\nimport { make_template_start_end, sizes_to_template_def, set_element_in_grid } from \"./grid-helpers\";\n\nconst Shiny = (window as any).Shiny;\n\nexport const shiny_exists: boolean = typeof Shiny !== \"undefined\";\n\ninterface Grid_Settings {\n  num_rows: (new_value: number) => void,\n  num_cols: (new_value: number) => void,\n  gap: CSS_Input\n};\n\nwindow.onload = function () {\n  draw_browser_header();\n  \n  // Keep track of the grid controls here. Tradeoff of a global variable\n  // feels worth it for direct access to the values without doing a dom query\n  const grid_controls = { rows: [], cols: [] };\n  // All the currently existing cells making up the grid\n  let current_cells = [];\n\n  // This holds the grid element dom node. Gets filled in the onload callback\n  // I am using a global variable here because we query inside this so much that\n  // it felt silly to regrab it every time as it never moves.\n  const grid_holder : HTMLElement = document.querySelector(\"#grid_holder\");\n  const settings_panel : HTMLElement = document.querySelector(\"#settings .card-body\");\n\n  const grid_settings: Grid_Settings = {\n    num_rows: make_incrementer({\n      parent_el: settings_panel,\n      id: \"num_rows\",\n      start_val: 2,\n      label: \"Number of rows\",\n      on_increment: (x) => update_num_rows_or_cols(\"rows\", x),\n    }),\n    num_cols: make_incrementer({\n      parent_el: settings_panel,\n      id: \"num_cols\",\n      start_val: 2,\n      label: \"Number of cols\",\n      on_increment: (x) => update_num_rows_or_cols(\"cols\", x),\n    }),\n    gap: make_css_unit_input({\n      parent_el: maybe_make_el(\n        settings_panel,\n        \"div#gap_size_chooser.plus_minus_input\",\n        {\n          innerHTML: `<span class = \"label\">Panel gap size</span>`,\n        }\n      ),\n      selector: \"#gap_size_chooser\",\n      on_change: (x) => update_grid({ gap: x }),\n      allowed_units: [\"px\", \"rem\"],\n    })\n  };\n\n  function update_num_rows_or_cols(dir, new_count) {\n    const current_vals =\n      dir === \"rows\" ? get_current_rows() : get_current_cols();\n\n    if (new_count > current_vals.length) {\n      current_vals.push(\"1fr\");\n    } else if (new_count < current_vals.length) {\n      current_vals.pop();\n    } else {\n      // No change, shouldn't happen but maybe...\n    }\n    update_grid({ [dir]: current_vals });\n  }\n\n  if (shiny_exists) {\n    Shiny.addCustomMessageHandler(\"update-grid\", function (opts) {\n      update_grid(opts);\n    });\n\n    Shiny.addCustomMessageHandler(\"add-elements\", function (elements_to_add) {\n      elements_to_add.forEach((el) => {\n        add_element({\n          id: el.id,\n          grid_rows: [el.start_row, el.end_row],\n          grid_cols: [el.start_col, el.end_col],\n        });\n      });\n    });\n\n    Shiny.addCustomMessageHandler(\"code_modal\", function (code_to_show) {\n      show_code(\n        \"Paste the following code into your app to update the layout\",\n        code_to_show\n      );\n    });\n  } else {\n    // If in pure-client-side mode we need to provide a default grid and also wireup the code button\n    update_grid({\n      rows: [\"1fr\", \"1fr\"],\n      cols: [\"1fr\", \"1fr\"],\n      gap: \"1rem\",\n    });\n\n    document.getElementById(\"get_code\").addEventListener(\"click\", function () {\n      const css_for_layout = current_layout_in_css();\n      show_code(\"Place the following in your CSS:\", css_for_layout);\n    });\n  }\n\n  function show_code(message, code_to_show) {\n    const code_modal = focused_modal({\n      modal_contents: message,\n      modal_callbacks: {\n        event: \"click\",\n        func: function (event) {\n          // This is needed to stop clicks on modal from triggering the cancel\n          // event that is attached to the background\n          event.stopPropagation();\n        },\n      },\n      styles: {\n        marginLeft: \"1rem\",\n      },\n      background_callbacks: {\n        event: \"click\",\n        func: close_modal,\n      },\n    });\n\n    const code_text = maybe_make_el(code_modal.modal, \"pre#code_for_layout\", {\n      innerHTML: code_to_show,\n      styles: {\n        background: \"#f3f2f2\",\n        padding: \"0.75rem\",\n        borderRadius: \"5px\",\n      },\n    });\n\n    const action_buttons = maybe_make_el(\n      code_modal.modal,\n      \"div#action_buttons\",\n      {\n        styles: {\n          display: \"flex\",\n          justifyContent: \"space-around\",\n        },\n      }\n    );\n    maybe_make_el(action_buttons, \"button#copy_code\", {\n      innerHTML: \"Copy to clipboard\",\n      event_listener: {\n        event: \"click\",\n        func: function () {\n          code_text.select();\n          document.execCommand(\"copy\");\n        },\n      },\n    });\n    maybe_make_el(action_buttons, \"button#close_code_model\", {\n      innerHTML: \"Close\",\n      event_listener: {\n        event: \"click\",\n        func: close_modal,\n      },\n    });\n\n    function close_modal() {\n      code_modal.remove();\n    }\n  }\n\n  function fill_grid_cells() {\n    const grid_dims = { rows: get_current_rows(), cols: get_current_cols() };\n    const num_rows = grid_dims.rows.length;\n    const num_cols = grid_dims.cols.length;\n    // Grab currently drawn cells (if any) so we can check if we need to redraw\n    // or if this was simply a column/row sizing update\n    current_cells = [];\n    const need_to_reset_cells = current_cells.length != num_rows * num_cols;\n\n    if (need_to_reset_cells) {\n      remove_elements(grid_holder.querySelectorAll(\".grid-cell\"));\n      for (let row_i = 1; row_i <= num_rows; row_i++) {\n        for (let col_i = 1; col_i <= num_cols; col_i++) {\n          current_cells.push(\n            maybe_make_el(grid_holder, `div.r${row_i}.c${col_i}.grid-cell`, {\n              data_props: { row: row_i, col: col_i },\n              grid_rows: [row_i],\n              grid_cols: [col_i],\n            })\n          );\n        }\n      }\n\n      // Build each column and row's sizing controler\n      for (let type in grid_controls) {\n        // Get rid of old ones to start with fresh slate\n        remove_elements(grid_holder.querySelectorAll(`.${type}-controls`));\n\n        grid_controls[type] = grid_dims[type].map(function (size, i) {\n          // The i + 1 is because grid is indexed at 1, not zero\n          const grid_i = i + 1;\n\n          return make_css_unit_input({\n            parent_el: grid_holder,\n            selector: `#control_${type}${grid_i}.${type}-controls`,\n            start_val: get_css_value(size),\n            start_unit: get_css_unit(size),\n            on_change: () => update_grid(get_layout_from_controls()),\n            form_styles: {\n              [`grid${\n                type === \"rows\" ? \"Row\" : \"Column\"\n              }`]: make_template_start_end([grid_i]),\n            },\n            drag_dir: type === \"rows\" ? \"y\" : \"x\",\n          });\n        });\n      }\n\n      const drag_detector = maybe_make_el(grid_holder, \"div#drag_detector\", {\n        event_listener: [\n          {\n            event: \"mousedown\",\n            func: drag_started,\n          },\n          {\n            event: \"mouseup\",\n            func: drag_ended,\n          },\n        ],\n      });\n      // Adding the dragging event to the whole page means we dont lose the drag\n      // the second the user's cursor goes off of the main grid div\n      document.querySelector(\"#editor\").addEventListener(\"mousemove\", dragging);\n\n      const current_selection_box = maybe_make_el(\n        grid_holder,\n        \"div#current_selection_box.added-element\"\n      );\n\n      // Lets the mousemove event listener know when to do stuff\n      let user_dragging = false;\n\n      // Drag start rel(ative) to grid editor div and positioned abs(olutely) on the whole page\n      // We need the absolute position to continue calculating drag after mouse has left editor\n      const drag_start = { rel: {}, abs: {} };\n      let sel_bounds;\n\n      function drag_started(event) {\n        user_dragging = true;\n        drag_start.rel = { x: event.offsetX, y: event.offsetY };\n        drag_start.abs = { x: event.clientX, y: event.clientY };\n        current_selection_box.style.borderColor = get_next_color();\n      }\n\n      function dragging(event) {\n        if (!user_dragging) return;\n\n        const d_x = event.clientX - drag_start.abs.x;\n        const d_y = event.clientY - drag_start.abs.y;\n\n        const sel_left = drag_start.rel.x + (d_x < 0 ? d_x : 0);\n        const sel_right = sel_left + Math.abs(d_x);\n        const sel_top = drag_start.rel.y + (d_y < 0 ? d_y : 0);\n        const sel_bottom = sel_top + Math.abs(d_y);\n\n        const selection_rect = {\n          x: [sel_left, sel_right],\n          y: [sel_top, sel_bottom],\n        };\n\n        sel_bounds = get_drag_extent_on_grid(selection_rect);\n\n        current_selection_box.style.display = \"block\";\n        set_element_in_grid(current_selection_box, sel_bounds);\n      }\n\n      function drag_ended(event) {\n        // Trigger naming dialog modal\n        name_new_element({\n          grid_rows: sel_bounds.row,\n          grid_cols: sel_bounds.col,\n          selection_box: current_selection_box,\n        });\n\n        user_dragging = false;\n      }\n\n      // Make sure any added elements sit on top by re-appending them to grid holder\n      // Make sure that the drag detector sits over everything\n      [\n        drag_detector,\n        ...grid_holder.querySelectorAll(\".added-element\"),\n      ].forEach((el) => grid_holder.appendChild(el));\n    } else {\n    }\n  }\n\n  function get_drag_extent_on_grid(selection_rect) {\n    // Reset bounding box definitions so we only use current selection extent\n    const sel_bounds = { col: [null, null], row: [null, null] };\n\n    current_cells.forEach(function (el) {\n      // Cell is overlapped by selection box\n      if (boxes_overlap(get_bounding_rect(el), selection_rect)) {\n        const el_row = +el.dataset.row;\n        const el_col = +el.dataset.col;\n        sel_bounds.row = [\n          min_w_missing(sel_bounds.row[0], el_row),\n          max_w_missing(sel_bounds.row[1], el_row),\n        ];\n        sel_bounds.col = [\n          min_w_missing(sel_bounds.col[0], el_col),\n          max_w_missing(sel_bounds.col[1], el_col),\n        ];\n      }\n    });\n\n    return sel_bounds;\n  }\n\n  function update_grid({ rows, cols, gap }) {\n    const old_num_rows = get_current_rows().length;\n    const old_num_cols = get_current_cols().length;\n    const old_gap = grid_holder.style.getPropertyValue(\"--grid-gap\");\n    const new_gap = gap || old_gap;\n    const new_num_rows = rows ? rows.length : old_num_rows;\n    const new_num_cols = cols ? cols.length : old_num_cols;\n\n    // Make sure settings panel is up-to-date\n    grid_settings.num_rows(new_num_rows);\n    grid_settings.num_cols(new_num_cols);\n    grid_settings.gap.update_value(new_gap);\n\n    const grid_numbers_changed =\n      old_num_rows !== new_num_rows || old_num_cols !== new_num_cols;\n    if (grid_numbers_changed) {\n      // Check for elements that may get dropped\n      const all_els = current_elements();\n      let in_danger_els = [];\n      let auto_removed_el_ids = [];\n\n      Object.values(all_els).forEach((el) => {\n        const sits_outside_grid =\n          el.end_row > new_num_rows || el.end_col > new_num_cols;\n        const completely_outside_grid =\n          el.start_row > new_num_rows || el.start_col > new_num_cols;\n\n        if (completely_outside_grid) {\n          auto_removed_el_ids.push(el.id);\n        } else if (sits_outside_grid) {\n          in_danger_els.push(el);\n        }\n      });\n      remove_added_elements(auto_removed_el_ids);\n\n      if (in_danger_els.length > 0) {\n        const fix_els_modal = focused_modal({\n          modal_contents: `\n        <h2>The following elements dont fit on the new grid layout.</h2>\n        <p>Below, choose to either remove the element or to shink its bounds to the new grid sizing</p>\n        `,\n        });\n\n        const radio_inputs_html = in_danger_els.reduce(\n          (radio_group, el) =>\n            `\n          ${radio_group}\n          <div class = \"radio-set-group\">\n            <div class = \"radio-set-label\"> ${el.id} </div>\n            <div class = \"radio-set-options\">\n              <input type=\"radio\" id = \"delete_${el.id}\" name=\"${el.id}\" value=\"delete\" checked>\n              <label for=\"delete_${el.id}\">Delete</label>\n              <input type=\"radio\" id = \"shrink_${el.id}\" name=\"${el.id}\" value=\"shrink\">\n              <label for=\"shrink_${el.id}\">Shink</label>\n            </div>\n          </div>\n        `,\n          \"\"\n        );\n\n        const delete_or_edit_form = maybe_make_el(\n          fix_els_modal.modal,\n          \"form#delete_or_fix_list\",\n          {\n            innerHTML: `<div class = \"update-action-form\"> ${radio_inputs_html} </div>`,\n            event_listener: {\n              event: \"submit\",\n              func: function () {\n                const form = this;\n                const to_delete = in_danger_els.filter(\n                  (d) => form[d.id].value === \"delete\"\n                );\n\n                remove_added_elements(to_delete.map((d) => d.id));\n                const to_edit = in_danger_els.filter(\n                  (d) => form[d.id].value === \"shrink\"\n                );\n                to_edit.forEach((el) => {\n                  const el_node = grid_holder.querySelector(`#${el.id}`);\n                  el_node.style.gridRow = make_template_start_end([\n                    el.start_row,\n                    Math.min(el.end_row, new_num_rows),\n                  ]);\n                  el_node.style.gridColumn = make_template_start_end([\n                    el.start_col,\n                    Math.min(el.end_col, new_num_cols),\n                  ]);\n                });\n\n                fix_els_modal.remove();\n                // Now that we've updated elements properly, we should be able to\n                // just recall the function and it won't spit an error\n                update_grid({ rows, cols, gap });\n              },\n            },\n          }\n        );\n\n        maybe_make_el(delete_or_edit_form, \"input#name_submit\", {\n          props: { type: \"submit\" },\n        });\n\n        maybe_make_el(fix_els_modal.modal, \"p.notice-text\", {\n          innerHTML:\n            \"Note that elements residing completely in the removed row or column are automatically deleted.\",\n        });\n\n        return;\n      }\n    }\n\n    if (rows) {\n      grid_holder.style.gridTemplateRows = sizes_to_template_def(rows);\n    }\n    if (cols) {\n      grid_holder.style.gridTemplateColumns = sizes_to_template_def(cols);\n    }\n    if (gap) {\n      // To give a consistant gap around everything we also add margin of same size\n      grid_holder.style.setProperty(\"--grid-gap\", gap);\n    }\n\n    if (grid_numbers_changed) fill_grid_cells();\n\n    if (shiny_exists) {\n      Shiny.setInputValue(\"grid_sizing\", {\n        rows: grid_holder.style.gridTemplateRows.split(\" \"),\n        cols: grid_holder.style.gridTemplateColumns.split(\" \"),\n        gap: grid_holder.style.getPropertyValue(\"--grid-gap\"),\n      });\n    }\n\n    return grid_holder;\n  }\n\n  function get_layout_from_controls() {\n    const sizes = {};\n    for (let type in grid_controls) {\n      sizes[type] = grid_controls[type].map((unit_input) =>\n        unit_input.current_value()\n      );\n    }\n    return sizes;\n  }\n\n  function name_new_element({ grid_rows, grid_cols, selection_box }) {\n    const modal_divs = focused_modal({\n      background_callbacks: {\n        // Clicking outside of the modal will cancel the naming. Seems natural\n        event: \"click\",\n        func: reset_el_creation,\n      },\n      modal_contents: `\n    <h2>Name your element:</h2>\n    <p>This name will be used to place items in your app.\n    For instance if you want to place a plot in this element,\n    this name will match the label of the plot output\n    </p>\n    `,\n      modal_callbacks: {\n        event: \"click\",\n        func: function (event) {\n          // This is needed to stop clicks on modal from triggering the cancel\n          // event that is attached to the background\n          event.stopPropagation();\n        },\n      },\n    });\n\n    const modal_div = modal_divs.modal;\n\n    const name_form = maybe_make_el(modal_div, \"form#name_form\", {\n      event_listener: {\n        event: \"submit\",\n        func: function () {\n          const id = this[\"name_input\"].value.replace(/\\s/g, \"_\");\n\n          if (current_elements()[id]) {\n            // Cant have duplicate ids!\n            warn_about_bad_id(\n              `You already have an element with the id ${id}, all ids need to be unique.`\n            );\n            return;\n          }\n          if (id.match(/^[^a-zA-Z]/g)) {\n            warn_about_bad_id(`Valid ids need to start with a character.`);\n            return;\n          }\n\n          // Add the new element in to grid\n          add_element({\n            id,\n            color: selection_box.style.borderColor,\n            grid_rows,\n            grid_cols,\n          });\n\n          reset_el_creation();\n        },\n      },\n    });\n    maybe_make_el(name_form, \"input#cancel_btn\", {\n      props: { type: \"button\", value: \"cancel\" },\n      event_listener: { event: \"click\", func: reset_el_creation },\n    });\n\n    maybe_make_el(name_form, \"input#name_input\", {\n      props: { type: \"text\" },\n      event_listener: {\n        // Don't leave warning message up while user is typing\n        event: \"input\",\n        func: hide_warning_msg,\n      },\n    }).focus(); // So user can immediately type in id\n\n    maybe_make_el(name_form, \"input#name_submit\", {\n      props: { type: \"submit\" },\n    });\n\n    function warn_about_bad_id(msg) {\n      maybe_make_el(modal_div, \"span#bad_id_msg.notice-text\", {\n        innerHTML: msg,\n        styles: { color: \"orangered\" },\n      });\n    }\n    function hide_warning_msg() {\n      const warn_msg = modal_div.querySelector(\"span#bad_id_msg\");\n      if (warn_msg) {\n        warn_msg.remove();\n      }\n    }\n    function reset_el_creation() {\n      // All done here so get rid of the whole interface.\n      modal_divs.remove();\n      // Remove the temporary dragged element\n      selection_box.style.display = \"none\";\n    }\n  }\n\n  // Adds a new element of a given id to the app. Both in the grid window\n  // and the addeded elements panel\n  function add_element({ id, color = get_next_color(), grid_cols, grid_rows }) {\n    const element_in_grid = maybe_make_el(\n      grid_holder,\n      `div#${id}.el_${id}.added-element`,\n      {\n        grid_cols,\n        grid_rows,\n        styles: {\n          borderColor: color,\n          position: \"relative\",\n        },\n      }\n    );\n\n    let drag_feedback_rect;\n    const feedback_border_w = 3;\n    // The shifting by border and padding here is hacky and probably a result\n    // of me not using the right event positions\n    const bounding_rect_to_pos = ({ x: [left, right], y: [top, bottom] }) => ({\n      left: `calc(${left}px - var(--side-gaps) - ${2 * feedback_border_w}px)`,\n      top: `calc(${top}px - var(--side-gaps) - ${2 * feedback_border_w}px)`,\n      width: `${right - left}px`,\n      height: `${bottom - top}px`,\n    });\n\n    [\"top-left\", \"bottom-right\", \"center\"].forEach(function (handle_type) {\n      // First we draw the handle that people see\n      maybe_make_el(element_in_grid, `div.dragger.visible.${handle_type}`, {\n        styles: { background: color, pointerEvents: \"none\" },\n        innerHTML:\n          handle_type === \"center\"\n            ? `<i class=\"fas fa-arrows-alt\"></i>`\n            : `<i class=\"fas fa-long-arrow-alt-up\"></i>`,\n      });\n      maybe_make_el(element_in_grid, `div.dragger.invisible.${handle_type}`, {\n        props: { draggable: true },\n        data_props: { handle_type },\n        event_listener: [\n          {\n            event: \"dragstart\",\n            func: function (event) {\n              // make sure dragged element is on top\n              grid_holder.appendChild(this.parentElement);\n              // Storing this info in the dom to avoid global variables\n              // The speed tradeoffs of the tiny json serialization are worth it imo\n              const starting_bound_box = get_bounding_rect(this.parentElement);\n              this.dataset.start_rect = JSON.stringify(starting_bound_box);\n              this.dataset.start_loc = JSON.stringify({\n                x: event.x,\n                y: event.y,\n              });\n\n              drag_feedback_rect = maybe_make_el(\n                grid_holder.querySelector(\"#drag_detector\"),\n                \"div.drag-feedback-rect\",\n                {\n                  styles: {\n                    border: `${feedback_border_w}px dashed var(--dark-gray)`,\n                    pointerEvents: \"none\",\n                    position: \"absolute\",\n                    ...bounding_rect_to_pos(starting_bound_box),\n                  },\n                }\n              );\n            },\n          },\n          {\n            event: \"drag\",\n            func: function (event) {\n              // Sometimes the drag event gets fired with nonsense zeros\n              if (event.x === 0 && event.y === 0) return;\n\n              const { x: start_x, y: start_y } = JSON.parse(\n                this.dataset.start_loc\n              );\n              const x_delta = event.x - start_x;\n              const y_delta = event.y - start_y;\n\n              const new_rect = JSON.parse(this.dataset.start_rect);\n\n              // The bounding here means that we dont let the user drag the box \"inside-out\"\n              if (this.dataset.handle_type === \"top-left\") {\n                new_rect.x[0] = Math.min(\n                  new_rect.x[0] + x_delta,\n                  new_rect.x[1]\n                );\n                new_rect.y[0] = Math.min(\n                  new_rect.y[0] + y_delta,\n                  new_rect.y[1]\n                );\n              } else if (this.dataset.handle_type === \"bottom-right\") {\n                new_rect.x[1] = Math.max(\n                  new_rect.x[1] + x_delta,\n                  new_rect.x[0]\n                );\n                new_rect.y[1] = Math.max(\n                  new_rect.y[1] + y_delta,\n                  new_rect.y[0]\n                );\n              } else {\n                // Just move the box\n                new_rect.x[0] += x_delta;\n                new_rect.y[0] += y_delta;\n                new_rect.x[1] += x_delta;\n                new_rect.y[1] += y_delta;\n              }\n\n              Object.assign(\n                drag_feedback_rect.style,\n                bounding_rect_to_pos(new_rect)\n              );\n              const grid_extent = get_drag_extent_on_grid(new_rect);\n              set_element_in_grid(this.parentElement, grid_extent);\n            },\n          },\n          {\n            event: \"dragend\",\n            func: function (event) {\n              drag_feedback_rect.remove();\n            },\n          },\n        ],\n      });\n    });\n\n    const element_in_list = maybe_make_el(\n      document.querySelector(\"#added_elements\"),\n      `div.el_${id}.added-element`,\n      {\n        innerHTML: id,\n        styles: {\n          borderColor: color,\n        },\n        event_listener: [\n          {\n            event: \"mouseover\",\n            func: function () {\n              this.classList.add(\"hovered\");\n              element_in_grid.classList.add(\"hovered\");\n            },\n          },\n          {\n            event: \"mouseout\",\n            func: function () {\n              this.classList.remove(\"hovered\");\n              element_in_grid.classList.remove(\"hovered\");\n            },\n          },\n        ],\n      }\n    );\n\n    maybe_make_el(element_in_list, \"button.remove_el\", {\n      innerHTML: `<i class=\"fa fa-trash\" aria-hidden=\"true\"></i>`,\n      event_listener: {\n        event: \"click\",\n        func: function () {\n          remove_added_elements(id);\n        },\n      },\n    });\n\n    // Let shiny know we have a new element\n    send_elements_to_shiny();\n  }\n\n  function current_elements() {\n    const all_elements = grid_holder.querySelectorAll(\".added-element\");\n\n    const element_info = {};\n    all_elements.forEach(function (el) {\n      // Ignore the selection box\n      if (el.id === \"current_selection_box\") return;\n      const grid_area = el.style.gridArea.split(\" / \");\n      element_info[el.id] = {\n        id: el.id,\n        start_row: +grid_area[0],\n        start_col: +grid_area[1],\n        // Subtract one here because the end in css is the end line, not row\n        end_row: +grid_area[2] - 1,\n        end_col: +grid_area[3] - 1,\n      };\n    });\n\n    return element_info;\n  }\n\n  function send_elements_to_shiny() {\n    if (shiny_exists) {\n      Shiny.setInputValue(\"elements\", current_elements());\n    }\n  }\n\n  function current_layout_in_css() {\n    const container_selector = \"#container\";\n    const elements_defs = Object.values(current_elements()).reduce(\n      (el_css, el) => `${el_css}\n\n${container_selector} #${el.id} {\n  grid-column: ${make_template_start_end([el.start_col, el.end_col])};\n  grid-row: ${make_template_start_end([el.start_row, el.end_row])};\n}\n`,\n      \"\"\n    );\n\n    return `${container_selector} {\n  display: grid;\n  grid-template-columns: ${grid_holder.style.gridTemplateColumns};\n  grid-template-rows: ${grid_holder.style.gridTemplateRows};\n  grid-gap: ${grid_holder.style.getPropertyValue(\"--grid-gap\")}\n}\n${elements_defs}`;\n  }\n\n  function get_current_rows() {\n    return grid_holder.style.gridTemplateRows.split(\" \");\n  }\n\n  function get_current_cols() {\n    return grid_holder.style.gridTemplateColumns.split(\" \");\n  }\n\n  // Get the next color in our list of colors.\n  function get_next_color() {\n    const colors = [\n      \"#e41a1c\",\n      \"#377eb8\",\n      \"#4daf4a\",\n      \"#984ea3\",\n      \"#ff7f00\",\n      \"#ffff33\",\n      \"#a65628\",\n      \"#f781bf\",\n    ];\n    const all_elements = grid_holder.querySelectorAll(\".added-element\");\n    // If we have more elements than colors we simply recycle\n    return colors[all_elements.length % colors.length];\n  }\n\n  // Removes elements the user has added to the grid by id\n  function remove_added_elements(ids) {\n    const ids_to_remove = ids instanceof Array ? ids : [ids];\n\n    ids_to_remove.forEach((el_id) => {\n      remove_elements(\n        document.querySelectorAll(`div.el_${el_id}.added-element`)\n      );\n    });\n\n    send_elements_to_shiny();\n  }\n}; // End of the window.onload callback\n// Passing an undefined value to a compare like min or max will always give undefined\n// These functions let you default to the second option in the case the first is falsy\nfunction compare_w_missing(compare_fn, maybe_a, b) {\n  return maybe_a ? compare_fn(maybe_a, b) : b;\n}\nfunction min_w_missing(maybe_a, b) {\n  return compare_w_missing(Math.min, maybe_a, b);\n}\nfunction max_w_missing(maybe_a, b) {\n  return compare_w_missing(Math.max, maybe_a, b);\n}\n\n// Produce bounding rectangle relative to parent of any element\nfunction get_bounding_rect({\n  offsetTop: top,\n  offsetLeft: left,\n  offsetHeight: height,\n  offsetWidth: width,\n}) {\n  return { x: [left, left + width], y: [top, top + height] };\n}\n\nfunction boxes_overlap(box_a, box_b) {\n  const horizontal_overlap = intervals_overlap(box_a.x, box_b.x);\n  const vertical_overlap = intervals_overlap(box_a.y, box_b.y);\n\n  return horizontal_overlap && vertical_overlap;\n\n  // Figure out of two intervals overlap eachother\n  function intervals_overlap([a_start, a_end], [b_start, b_end]) {\n    //   aaaaaaaaaa\n    // bbbbbb\n    //         bbbbbb\n    const a_contains_b_endpoint =\n      (a_start >= b_start && a_start <= b_end) ||\n      (a_end >= b_start && a_end <= b_end);\n\n    //   aaaaaa\n    // bbbbbbbbbb\n    const b_covers_a = a_start <= b_start && a_end >= b_end;\n\n    return a_contains_b_endpoint || b_covers_a;\n  }\n}\n\nexport function get_css_unit(css_size) {\n  return css_size.match(/[^ \\d | \\.]+$/g)[0] || \"px\";\n}\n\nexport function get_css_value(css_size) {\n  return +css_size.match(/^[\\d | \\.]+/g);\n}\n\nwindow.onresize = function () {\n  draw_browser_header();\n};\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}